// Continuous integration for the OS X Platform also runs the tests in the
// iPhone, Apple TV and Apple Watch simulators. We only need to run the
// build_swift module unit-tests once per OSX Platform test run, rather than
// once for each supported Apple device.

// UNSUPPORTED: OS=ios
// UNSUPPORTED: OS=tvos
// UNSUPPORTED: OS=watchos

// RUN: %{python} %utils/build_swift/run_tests.py

// TODO: Fix me.
// $ li validation-test/Python/build_swift.swift.disabled
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:247: note: using swift: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/swift-linux-x86_64/bin/swift
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:247: note: using swiftc: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/swift-linux-x86_64/bin/swiftc
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:247: note: using sil-opt: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/swift-linux-x86_64/bin/sil-opt
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:247: note: using sil-func-extractor: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/swift-linux-x86_64/bin/sil-func-extractor
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:247: note: using sil-llvm-gen: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/swift-linux-x86_64/bin/sil-llvm-gen
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:247: note: using sil-nm: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/swift-linux-x86_64/bin/sil-nm
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:247: note: using sil-passpipeline-dumper: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/swift-linux-x86_64/bin/sil-passpipeline-dumper
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:247: note: using lldb-moduleimport-test: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/swift-linux-x86_64/bin/lldb-moduleimport-test
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:247: note: using swift-ide-test: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/swift-linux-x86_64/bin/swift-ide-test
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:247: note: using swift-syntax-test: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/swift-linux-x86_64/bin/swift-syntax-test
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:247: note: using swift-syntax-parser-test: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/swift-linux-x86_64/bin/swift-syntax-parser-test
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:247: note: using swift-reflection-dump: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/swift-linux-x86_64/bin/swift-reflection-dump
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:247: note: using swift-remoteast-test: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/swift-linux-x86_64/bin/swift-remoteast-test
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:247: note: using swift-indent: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/swift-linux-x86_64/bin/swift-indent
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:247: note: using swift-symbolgraph-extract: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/swift-linux-x86_64/bin/swift-symbolgraph-extract
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:247: note: using clang: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/llvm-linux-x86_64/bin/clang
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:247: note: using llvm-link: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/llvm-linux-x86_64/bin/llvm-link
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:247: note: using swift-llvm-opt: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/swift-linux-x86_64/bin/swift-llvm-opt
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:247: note: using llvm-profdata: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/llvm-linux-x86_64/bin/llvm-profdata
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:247: note: using llvm-cov: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/llvm-linux-x86_64/bin/llvm-cov
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:247: note: using llvm-strings: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/llvm-linux-x86_64/bin/llvm-strings
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:247: note: using FileCheck: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/llvm-linux-x86_64/bin/FileCheck
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:247: note: using llvm-dwarfdump: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/llvm-linux-x86_64/bin/llvm-dwarfdump
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:247: note: using llvm-dis: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/llvm-linux-x86_64/bin/llvm-dis
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:247: note: using sourcekitd-test: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/swift-linux-x86_64/bin/sourcekitd-test
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:247: note: using complete-test: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/swift-linux-x86_64/bin/complete-test
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:247: note: using swift-api-digester: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/swift-linux-x86_64/bin/swift-api-digester
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:247: note: using swift-refactor: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/swift-linux-x86_64/bin/swift-refactor
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:247: note: using swift-demangle-yamldump: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/swift-linux-x86_64/bin/swift-demangle-yamldump
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:250: warning: couldn't find 'Benchmark_O' program, try setting BENCHMARK_O in your environment
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:250: warning: couldn't find 'Benchmark_Driver' program, try setting BENCHMARK_DRIVER in your environment
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:318: note: Using resource dir: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/swift-linux-x86_64/lib/swift
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:346: note: Compiling with -swift-version 4
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:369: note: Using Clang module cache: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/swift-linux-x86_64/swift-test-results/x86_64-unknown-linux-gnu/clang-module-cache
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:370: note: Using test results dir: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/swift-linux-x86_64/./swift-test-results/x86_64-unknown-linux-gnu
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:375: note: Using code completion cache: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/swift-linux-x86_64/swift-test-results/x86_64-unknown-linux-gnu/completion-cache
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:1048: note: Testing Linux x86_64-unknown-linux-gnu
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:247: note: using swift-autolink-extract: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/swift-linux-x86_64/bin/swift-autolink-extract
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:1483: note: Using platform module dir: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/swift-linux-x86_64/lib/swift/linux/x86_64
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:1503: note: Testing with the just-built libraries at /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/swift-linux-x86_64/lib/swift/linux/x86_64
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:247: note: using swift-reflection-test-linux-x86_64: /usr/local/google/home/burmako/swift-base/build/Ninja-ReleaseAssert+stdlib-Release/swift-linux-x86_64/bin/swift-reflection-test-linux-x86_64
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:1754: note: Running tests on Debian-rodete
// lit.py: /usr/local/google/home/burmako/swift-base/swift/test/lit.cfg:1764: note: Available features: CMAKE_GENERATOR=Ninja, CODEGENERATOR=AArch64, CODEGENERATOR=ARM, CODEGENERATOR=Mips, CODEGENERATOR=PowerPC, CODEGENERATOR=SystemZ, CODEGENERATOR=X86, CPU=x86_64, LinuxDistribution=Debian-rodete, OS=linux-gnu, PTRSIZE=64, SWIFT_VERSION=4, VENDOR=unknown, asan_runtime, asserts, autolink-extract, crash-recovery, differentiable_programming, executable_test, fuzzer_runtime, libxml2, no_asan, no_lto, nonexecutable_test, optimized_stdlib, optimized_stdlib_x86_64, sftp_server, shell, sourcekit, standalone_build, swift-remoteast-test, swift_interpreter, swift_stdlib_no_asserts, swift_test_mode_optimize_none, swift_test_mode_optimize_none_x86_64, swift_tools_extra, syntax_parser_lib, tensorflow, ubsan_runtime
// FAIL: Swift(linux-x86_64) :: Python/build_swift.swift.disabled (1 of 1)
// ******************** TEST 'Swift(linux-x86_64) :: Python/build_swift.swift.disabled' FAILED ********************
// Script:
// --
// : 'RUN: at line 10';   /usr/bin/python /usr/local/google/home/burmako/swift-base/swift/utils/build_swift/run_tests.py
// --
// Exit Code: 1
//
// Command Output (stderr):
// --
// .......................................................................................ssssssssssssssss.........................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................FFFFF.....................................................................................................................................................................................ssssss..sssssss..ss..ssss...s.ss......sssssssssssssssssssssss.sss
// ======================================================================
// FAIL: test_preset_tensorflow_osx (tests.build_swift.test_driver_arguments.buildbot,tools=RA-flto,stdlib=RDA)
// ----------------------------------------------------------------------
// Traceback (most recent call last):
//   File "/usr/local/google/home/burmako/swift-base/swift/utils/build_swift/tests/build_swift/test_driver_arguments.py", line 329, in test
//     preset_name, e))
// AssertionError: failed to parse preset "tensorflow_osx": failed to parse impl arguments: [u'--swift-enable-ast-verifier=0', u'--lldb-no-debugserver', u'--lldb-use-system-debugserver', u'--lldb-build-type=Release', u'--playgroundsupport-build-type=Release', u'--install-lldb', u'--install-llbuild', u'--skip-install-swiftsyntax-module', u'--install-playgroundsupport', u'--darwin-install-extract-symbols', u'--test-installable-package', u'--reconfigure', u'--swift-install-components=compiler;clang-resource-dir-symlink;stdlib;sdk-overlay;parser-lib;toolchain-tools;license;sourcekit-xpc-service;swift-remote-mirror;swift-remote-mirror-headers', u'--llvm-install-components=llvm-cov;llvm-profdata;IndexStore;clang;clang-resource-headers;compiler-rt;clangd', u'--install-libcxx', u'--installable-package=/tmp/install/pkg', u'--darwin-toolchain-bundle-identifier=BundleIdentifier', u'--darwin-toolchain-display-name=DisplayName', u'--darwin-toolchain-display-name-short=DispalyNameShort', u'--darwin-toolchain-name=default', u'--darwin-toolchain-version=1.0', u'--darwin-toolchain-alias=Alias', u'--swift-primary-variant-sdk=OSX', u'--swift-primary-variant-arch=x86_64', u'--install-tensorflow', u'--install-swift']
//
// ======================================================================
// FAIL: test_preset_tensorflow_osx,installer (tests.build_swift.test_driver_arguments.buildbot,tools=RA-flto,stdlib=RDA)
// ----------------------------------------------------------------------
// Traceback (most recent call last):
//   File "/usr/local/google/home/burmako/swift-base/swift/utils/build_swift/tests/build_swift/test_driver_arguments.py", line 329, in test
//     preset_name, e))
// AssertionError: failed to parse preset "tensorflow_osx,installer": failed to parse impl arguments: [u'--swift-enable-ast-verifier=0', u'--lldb-no-debugserver', u'--lldb-use-system-debugserver', u'--lldb-build-type=Release', u'--playgroundsupport-build-type=Release', u'--install-lldb', u'--install-llbuild', u'--skip-install-swiftsyntax-module', u'--install-playgroundsupport', u'--darwin-install-extract-symbols', u'--test-installable-package', u'--reconfigure', u'--swift-install-components=compiler;clang-resource-dir-symlink;stdlib;sdk-overlay;parser-lib;toolchain-tools;license;sourcekit-xpc-service;swift-remote-mirror;swift-remote-mirror-headers', u'--llvm-install-components=llvm-cov;llvm-profdata;IndexStore;clang;clang-resource-headers;compiler-rt;clangd', u'--install-libcxx', u'--installable-package=/tmp/install/pkg', u'--darwin-toolchain-bundle-identifier=BundleIdentifier', u'--darwin-toolchain-display-name=DisplayName', u'--darwin-toolchain-display-name-short=DispalyNameShort', u'--darwin-toolchain-name=default', u'--darwin-toolchain-version=1.0', u'--darwin-toolchain-alias=Alias', u'--swift-primary-variant-sdk=OSX', u'--swift-primary-variant-arch=x86_64', u'--install-tensorflow', u'--darwin-toolchain-application-cert=lldb_codesign', u'--darwin-toolchain-installer-package=/tmp/install/swift-installer.pkg', u'--install-swift']
//
// ======================================================================
// FAIL: test_preset_tensorflow_osx,no_test (tests.build_swift.test_driver_arguments.buildbot,tools=RA-flto,stdlib=RDA)
// ----------------------------------------------------------------------
// Traceback (most recent call last):
//   File "/usr/local/google/home/burmako/swift-base/swift/utils/build_swift/tests/build_swift/test_driver_arguments.py", line 329, in test
//     preset_name, e))
// AssertionError: failed to parse preset "tensorflow_osx,no_test": failed to parse impl arguments: [u'--swift-enable-ast-verifier=0', u'--lldb-no-debugserver', u'--lldb-use-system-debugserver', u'--lldb-build-type=Release', u'--playgroundsupport-build-type=Release', u'--install-lldb', u'--install-llbuild', u'--skip-install-swiftsyntax-module', u'--install-playgroundsupport', u'--darwin-install-extract-symbols', u'--test-installable-package', u'--reconfigure', u'--swift-install-components=compiler;clang-resource-dir-symlink;stdlib;sdk-overlay;parser-lib;toolchain-tools;license;sourcekit-xpc-service;swift-remote-mirror;swift-remote-mirror-headers', u'--llvm-install-components=llvm-cov;llvm-profdata;IndexStore;clang;clang-resource-headers;compiler-rt;clangd', u'--install-libcxx', u'--installable-package=/tmp/install/pkg', u'--darwin-toolchain-bundle-identifier=BundleIdentifier', u'--darwin-toolchain-display-name=DisplayName', u'--darwin-toolchain-display-name-short=DispalyNameShort', u'--darwin-toolchain-name=default', u'--darwin-toolchain-version=1.0', u'--darwin-toolchain-alias=Alias', u'--swift-primary-variant-sdk=OSX', u'--swift-primary-variant-arch=x86_64', u'--install-tensorflow', u'--skip-test-cmark', u'--skip-test-llbuild', u'--skip-test-lldb', u'--skip-test-playgroundsupport', u'--skip-test-swift', u'--install-swift']
//
// ======================================================================
// FAIL: test_preset_tensorflow_osx,no_test,installer (tests.build_swift.test_driver_arguments.buildbot,tools=RA-flto,stdlib=RDA)
// ----------------------------------------------------------------------
// Traceback (most recent call last):
//   File "/usr/local/google/home/burmako/swift-base/swift/utils/build_swift/tests/build_swift/test_driver_arguments.py", line 329, in test
//     preset_name, e))
// AssertionError: failed to parse preset "tensorflow_osx,no_test,installer": failed to parse impl arguments: [u'--swift-enable-ast-verifier=0', u'--lldb-no-debugserver', u'--lldb-use-system-debugserver', u'--lldb-build-type=Release', u'--playgroundsupport-build-type=Release', u'--install-lldb', u'--install-llbuild', u'--skip-install-swiftsyntax-module', u'--install-playgroundsupport', u'--darwin-install-extract-symbols', u'--test-installable-package', u'--reconfigure', u'--swift-install-components=compiler;clang-resource-dir-symlink;stdlib;sdk-overlay;parser-lib;toolchain-tools;license;sourcekit-xpc-service;swift-remote-mirror;swift-remote-mirror-headers', u'--llvm-install-components=llvm-cov;llvm-profdata;IndexStore;clang;clang-resource-headers;compiler-rt;clangd', u'--install-libcxx', u'--installable-package=/tmp/install/pkg', u'--darwin-toolchain-bundle-identifier=BundleIdentifier', u'--darwin-toolchain-display-name=DisplayName', u'--darwin-toolchain-display-name-short=DispalyNameShort', u'--darwin-toolchain-name=default', u'--darwin-toolchain-version=1.0', u'--darwin-toolchain-alias=Alias', u'--swift-primary-variant-sdk=OSX', u'--swift-primary-variant-arch=x86_64', u'--install-tensorflow', u'--skip-test-cmark', u'--skip-test-llbuild', u'--skip-test-lldb', u'--skip-test-playgroundsupport', u'--darwin-toolchain-application-cert=lldb_codesign', u'--darwin-toolchain-installer-package=/tmp/install/swift-installer.pkg', u'--skip-test-swift', u'--install-swift']
//
// ======================================================================
// FAIL: test_preset_tensorflow_osx_base (tests.build_swift.test_driver_arguments.buildbot,tools=RA-flto,stdlib=RDA)
// ----------------------------------------------------------------------
// Traceback (most recent call last):
//   File "/usr/local/google/home/burmako/swift-base/swift/utils/build_swift/tests/build_swift/test_driver_arguments.py", line 329, in test
//     preset_name, e))
// AssertionError: failed to parse preset "tensorflow_osx_base": failed to parse impl arguments: [u'--swift-enable-ast-verifier=0', u'--lldb-no-debugserver', u'--lldb-use-system-debugserver', u'--lldb-build-type=Release', u'--playgroundsupport-build-type=Release', u'--install-lldb', u'--install-llbuild', u'--skip-install-swiftsyntax-module', u'--install-playgroundsupport', u'--darwin-install-extract-symbols', u'--test-installable-package', u'--reconfigure', u'--swift-install-components=compiler;clang-resource-dir-symlink;stdlib;sdk-overlay;parser-lib;toolchain-tools;license;sourcekit-xpc-service;swift-remote-mirror;swift-remote-mirror-headers', u'--llvm-install-components=llvm-cov;llvm-profdata;IndexStore;clang;clang-resource-headers;compiler-rt;clangd', u'--install-libcxx', u'--installable-package=/tmp/install/pkg', u'--darwin-toolchain-bundle-identifier=BundleIdentifier', u'--darwin-toolchain-display-name=DisplayName', u'--darwin-toolchain-display-name-short=DispalyNameShort', u'--darwin-toolchain-name=default', u'--darwin-toolchain-version=1.0', u'--darwin-toolchain-alias=Alias', u'--swift-primary-variant-sdk=OSX', u'--swift-primary-variant-arch=x86_64', u'--install-tensorflow', u'--install-swift']
//
// ----------------------------------------------------------------------
// Ran 923 tests in 11.238s
//
// FAILED (failures=5, skipped=64)
//
// --
//
// ********************
// Testing Time: 11.79s
// ********************
// Failing Tests (1):
//     Swift(linux-x86_64) :: Python/build_swift.swift.disabled
//
//   Unexpected Failures: 1
//
// 2 warning(s) in tests.
